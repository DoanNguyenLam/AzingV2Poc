<?xml version="1.0" encoding="UTF-8"?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" version="2.0" xmlns:form="http://www.springframework.org/tags/form"
          xmlns:c="http://java.sun.com/jsp/jstl/core"
          xmlns:portlet="http://xmlns.jcp.org/portlet_3_0">
    <jsp:directive.page contentType="text/html;charset=UTF-8" />
    <jsp:output omit-xml-declaration="yes" />

    <div id="email-portlet" class="container">
        <div class="row gx-2">
            <div class="col-3">
                <div class="list-mails">
                    <c:forEach items="${listMails}" var="item">
                        <portlet:actionURL var="fetchData">
                            <portlet:param name="action" value="fetchData"/>
                            <portlet:param name="thread-id" value="${item.threadId}"/>
                            <portlet:param name="id" value="${item.id}"/>
                        </portlet:actionURL>
                        <form:form action="${fetchData}" method="post" class="card email-card w-100 mb-3">
                            <div class="card-body">
                                <div class="title">
                                    <h5 class="card-title">
                                        ${item.subject}
                                    </h5>
                                </div>
                                <div class="body">
                                    <p class="card-text">
                                        ${item.bodyPlainText}
                                    </p>
                                </div>
                                <div class="date">
                                    <p>${item.date}</p>
                                </div>
                            </div>
                        </form:form>
                    </c:forEach>

                </div>
            </div>
            <div class="col-5">
                <div class="original-email">
                    <div class="card email-card w-100 mb-3 active">
                        <div class="card-body">

                            <div class="title d-flex align-items-center gap-2 pb-2">
                                <h4 class="card-title mb-0">Original email</h4>
                            </div>
                            <div class="body mt-3">
                                <c:choose>
                                    <c:when test="${not empty originalEmail}">
                                        <div class="original">
                                            ${originalEmail}
                                        </div>
                                    </c:when>
                                    <c:otherwise>
                                        <div class="no-selected">
                                            Please select an email to summary.
                                        </div>
                                    </c:otherwise>
                                </c:choose>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-4">
                <div class="ai-tool">
                    <div class="email-labels">
                        <div class="card email-card w-100 mb-3 active">
                            <div class="card-body">
                                <div class="title d-flex align-items-center gap-2 pb-2">
                                   <h4 class="card-title mb-0">Email Tags</h4>
                                </div>
                                <div class="body mt-3">
                                    <div class="tag">
                                        <c:choose>
                                            <c:when test="${empty labelsGG and empty labelsAI}">
                                                <div class="no-selected">
                                                    Please select an email to view label.
                                                </div>
                                            </c:when>
                                            <c:otherwise>
                                                <div class="gg">
                                                    <h6> Google: </h6>
                                                    <div class="label-items">
                                                        <c:forEach items="${labelsGG}" var="label">
                                                            <portlet:actionURL var="removeLabel">
                                                                <portlet:param name="action" value="removeLabel"/>
                                                                <portlet:param name="thread-id" value="${threadId}"/>
                                                                <portlet:param name="id" value="${id}"/>
                                                                <portlet:param name="labelId" value="${label.id}"/>
                                                            </portlet:actionURL>
                                                            <form:form class="label-form" action="${removeLabel}" method="post">
                                                                <c:choose>
                                                                    <c:when test="${not empty label.color}">
                                                                <span class="label-color" style="color: ${label.color.textColor}; background-color: ${label.color.backgroundColor};">
                                                                    ${label.name}
                                                                </span>
                                                                    </c:when>
                                                                    <c:otherwise>
                                                                <span class="label-color">
                                                                    ${label.name}
                                                                </span>
                                                                    </c:otherwise>
                                                                </c:choose>
                                                            </form:form>

                                                        </c:forEach>
                                                    </div>
                                                </div>
                                                <div class="ai">
                                                    <h6> AI generator: </h6>
                                                    <div class="label-items">
                                                        <c:forEach items="${labelsAI}" var="labelAI">
                                                            <portlet:actionURL var="addLabel">
                                                                <portlet:param name="action" value="addLabel"/>
                                                                <portlet:param name="thread-id" value="${threadId}"/>
                                                                <portlet:param name="id" value="${id}"/>
                                                                <portlet:param name="labelName" value="${labelAI.labelName}"/>
                                                                <!--                                                        <portlet:param name="isAIGenerate" value="${label.isAIGenerate}"/>-->
                                                            </portlet:actionURL>
                                                            <form:form class="label-form" action="${addLabel}" method="post">
                                                          <span class="label-color">
                                                                ${labelAI.labelName}
                                                            </span>
                                                            </form:form>

                                                        </c:forEach>
                                                    </div>
                                                </div>
                                            </c:otherwise>
                                        </c:choose>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="email-summary">
                        <div class="card email-card w-100 mb-3 active">
                            <div class="card-body">
                                <div class="title d-flex align-items-center gap-2 pb-2">
                                    <h4 class="card-title mb-0">Email summary</h4>
                                </div>
                                <div class="body mt-3">
                                <c:choose>
                                    <c:when test="${not empty summary}">
                                        <div class="summary">
                                            ${summary}
                                        </div>
                                    </c:when>
                                    <c:otherwise>
                                        <div class="no-selected">
                                            Please select an email to summary.
                                        </div>
                                    </c:otherwise>
                                </c:choose>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="reply-suggestion">
                        <div class="card email-card w-100 mb-3 active">
                            <div class="card-body">
                                <div class="title">
                                    <div class="title d-flex align-items-center gap-2 pb-2">
                                        <h4 class="card-title mb-0">Reply suggestion</h4>
                                    </div>
                                </div>
                                <div class="body mt-3">
                                    <c:choose>
                                        <c:when test="${not empty suggestion}">
                                            <div class="reply-suggestion">
                                                ${suggestion}
                                            </div>
                                        </c:when>
                                        <c:otherwise>
                                            <div class="no-selected">
                                                Please select an email to summary.
                                            </div>
                                        </c:otherwise>
                                    </c:choose>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="${pageContext.request.contextPath}/js/script.js"></script>
</jsp:root>
